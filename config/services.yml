services:
  document.registry:
    class: Vainyl\Document\Registry\DocumentRegistry
    arguments: ['@storage.prototype']
  document.operation.factory:
    factory: ['@document.registry', 'getFactory']
    arguments:
      - 'factory'
  document.hydrator:
    factory: ['@document.registry', 'getHydrator']
    arguments:
      - 'hydrator'
  database.document:
    factory: ['@document.registry', 'getDatabase']
    arguments:
      - 'database'
  document.operation.factory.event:
    decorates: document.operation.factory
    decoration_priority: 1000
    class: Vainyl\Document\Operation\Decorator\EventDocumentOperationFactoryDecorator
    arguments: ['@document.operation.factory.event.inner', '@collection.factory.sequence', '@event.dispatcher.collection']